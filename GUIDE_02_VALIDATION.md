# ๐ ุฑุงูููุง ุชูุตู: `02_validation.php`

## ๐ฏ ุฎูุงุตูโ ฺฉู

ุงู ูุงู ฺฉ ุงุฒ **ูููโุชุฑู ููุงูู ุงููุช ูุจ** ุฑุง ูุดุงู ูโุฏูุฏ: **ุงุนุชุจุงุฑุณูุฌ ูุฑูุฏโูุง (Input Validation)**.

ููุช ฺฉุงุฑุจุฑ ุฏุงุฏูโุง ุงุฑุณุงู ูโฺฉูุฏุ ุณุฑูุฑ ุจุงุฏ ุจุฑุฑุณ ฺฉูุฏ:
- โ ุขุง ุฏุงุฏู ุฎุงู ูุณุชุ
- โ ุขุง ูุฑูุช ุตุญุญ ุงุณุชุ
- โ ุขุง ุทูู ููุงุณุจ ุงุณุชุ
- โ ุขุง ููุน ุฏุงุฏู ุฏุฑุณุช ุงุณุชุ

ุงฺฏุฑ ุงู ุจุฑุฑุณโูุง ุงูุฌุงู ูุดูุฏุ ูฺฉุฑ ูโุชูุงูุฏ ุณุณุชู ุฑุง ุดฺฉุณุช ุฏูุฏ.

---

## ๐ ุณุงุฎุชุงุฑ ูุงู

```
02_validation.php
โโโ PHP Logic (Server-side)
โ   โโโ ูุชุบุฑูุง ุงููู
โ   โโโ ุจุฑุฑุณ POST
โ   โโโ Validation Rules
โ   โโโ ูุชุฌู (ูููู/ูุงูููู)
โโโ HTML Form
โ   โโโ ูููููโูุง ูุงุจู ฺฉูฺฉ
โ   โโโ ูุฑูุฏโูุง ูุฑู
โ   โโโ ููุงุด ุฎุทุงูุง
โโโ JavaScript Functions
    โโโ fillForm()
```

---

## ๐ ุชุญูู ฺฉุฏ - ุจุฎุด ุจู ุจุฎุด

### ุจุฎุด 1: ูุชุบุฑูุง ุงููู

```php
$errors = [];
$success = false;
$name = '';
$email = '';
$age = '';
```

**ุชูุถุญ:**
- `$errors`: ุขุฑุงูโุง ุจุฑุง ุฐุฎุฑู ูพุงูโูุง ุฎุทุง
- `$success`: ูุดุงูฺฏุฑ ููููุช ุงุนุชุจุงุฑุณูุฌ
- `$name`, `$email`, `$age`: ูุชุบุฑูุง ูุฑูุฏ

---

### ุจุฎุด 2: ุจุฑุฑุณ POST ู ุฏุฑุงูุช ุฏุงุฏูโูุง

```php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Retrieve and sanitize input - Developed by Amin Davodian
    $name = trim($_POST['name'] ?? '');
    $email = trim($_POST['email'] ?? '');
    $age = trim($_POST['age'] ?? '');
```

**ุชูุถุญ:**

#### ุงูู) `$_SERVER["REQUEST_METHOD"] == "POST"`
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ูุฑู ุงุฑุณุงู ุดุฏู ุงุณุช
- ุงฺฏุฑ ุตูุญู ุจุฑุง ุงููู ุจุงุฑ ุจุงุฒ ุดูุฏุ ุงู ุดุฑุท false ุงุณุช

#### ุจ) `trim()`
- ูุถุงูุง ุฎุงู ุฏุฑ ุงุจุชุฏุง ู ุงูุชูุง ุฑุดุชู ุฑุง ุญุฐู ูโฺฉูุฏ
- ูุซุงู: `"  ุนู  "` โ `"ุนู"`

#### ุฌ) `$_POST['name'] ?? ''`
- ุงฺฏุฑ `$_POST['name']` ูุฌูุฏ ูุฏุงุดุชุ ููุฏุงุฑ ุฎุงู ุงุณุชูุงุฏู ูโุดูุฏ
- ุฌููฺฏุฑ ุงุฒ ุฎุทุง "undefined index"

---

### ุจุฎุด 3: Validation Logic - ูุงู

```php
if (empty($name)) {
    $errors['name'] = "ูุทูุงู ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ.";
} elseif (mb_strlen($name) < 3) {
    $errors['name'] = "ูุงู ุจุงุฏ ุญุฏุงูู ณ ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ.";
}
```

**ุชูุถุญ:**

#### ุงูู) `empty($name)`
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ูุงู ุฎุงู ูุณุช
- ุงฺฏุฑ ุฎุงู ุจูุฏุ ุฎุทุง ุซุจุช ูโุดูุฏ

#### ุจ) `mb_strlen($name) < 3`
- `mb_strlen()`: ุทูู ุฑุดุชู ุฑุง ุจุฑุง ูุงุฑุณ ุตุญุญ ูุญุงุณุจู ูโฺฉูุฏ
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ูุงู ุญุฏุงูู ณ ฺฉุงุฑุงฺฉุชุฑ ุงุณุช
- ูุซุงู: `"ุนู"` = ณ ฺฉุงุฑุงฺฉุชุฑ โ

**ูฺฉุชู:** `strlen()` ุจุฑุง ูุงุฑุณ ุงุดุชุจุงู ุงุณุชุ ุจุงุฏ `mb_strlen()` ุงุณุชูุงุฏู ุดูุฏ

---

### ุจุฎุด 4: Validation Logic - ุงูู

```php
if (empty($email)) {
    $errors['email'] = "ุงูู ุงูุฒุงู ุงุณุช.";
} elseif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
    $errors['email'] = "ูุฑูุช ุงูู ุตุญุญ ูุณุช.";
}
```

**ุชูุถุญ:**

#### ุงูู) `empty($email)`
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุงูู ุฎุงู ูุณุช

#### ุจ) `filter_var($email, FILTER_VALIDATE_EMAIL)`
- ุชุงุจุน PHP ุจุฑุง ุงุนุชุจุงุฑุณูุฌ ุงูู
- ุจุฑุฑุณ ูโฺฉูุฏ:
  - ุขุง `@` ูุฌูุฏ ุฏุงุฑุฏุ
  - ุขุง ุฏุงููู ูุนุชุจุฑ ุงุณุชุ
  - ุขุง ูุฑูุช ุตุญุญ ุงุณุชุ

**ูุซุงูโูุง ูุนุชุจุฑ:**
```
amin@example.com โ
user.name@domain.co.uk โ
test+tag@gmail.com โ
```

**ูุซุงูโูุง ูุงูุนุชุจุฑ:**
```
invalid-email โ (ุจุฏูู @)
user@.com โ (ุจุฏูู ูุงู ุฏุงููู)
@example.com โ (ุจุฏูู ูุงู ฺฉุงุฑุจุฑ)
```

---

### ุจุฎุด 5: Validation Logic - ุณู

```php
if (empty($age)) {
    $errors['age'] = "ุณู ุงูุฒุงู ุงุณุช.";
} elseif (!is_numeric($age) || $age < 18) {
    $errors['age'] = "ุณู ุจุงุฏ ุนุฏุฏ ู ุญุฏุงูู ฑธ ุณุงู ุจุงุดุฏ.";
}
```

**ุชูุถุญ:**

#### ุงูู) `empty($age)`
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุณู ุฎุงู ูุณุช

#### ุจ) `is_numeric($age)`
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุณู ฺฉ ุนุฏุฏ ุงุณุช
- ูุซุงู: `"25"` โุ `"ุจุณุช"` โ

#### ุฌ) `$age < 18`
- ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุณู ุญุฏุงูู ฑธ ุณุงู ุงุณุช
- ูุซุงู: `25` โุ `10` โ

---

### ุจุฎุด 6: ุจุฑุฑุณ ูุชุฌู

```php
if (empty($errors)) {
    $success = true;
}
```

**ุชูุถุญ:**
- ุงฺฏุฑ ุขุฑุงู `$errors` ุฎุงู ุงุณุชุ ุชูุงู ุงุนุชุจุงุฑุณูุฌโูุง ูููู ุจูุฏูุฏ
- `$success = true` ุชูุธู ูโุดูุฏ

---

### ุจุฎุด 7: ููุงุด ูุชุฌู - ููููุช

```php
<?php if ($success): ?>
    <div class="alert alert-success">
        โ <strong>ุชุจุฑฺฉ!</strong> ุงุทูุงุนุงุช ุดูุง ุจุง ููููุช ุชุงุฏ ุดุฏ.<br>
        ูุงู: <?php echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8'); ?><br>
        ุงูู: <?php echo htmlspecialchars($email, ENT_QUOTES, 'UTF-8'); ?>
    </div>
<?php endif; ?>
```

**ุชูุถุญ:**
- ุงฺฏุฑ `$success` true ุงุณุชุ ูพุงู ููููุช ููุงุด ุฏุงุฏู ูโุดูุฏ
- ุฏุงุฏูโูุง ุจุง `htmlspecialchars()` escape ูโุดููุฏ

---

### ุจุฎุด 8: ููุงุด ูุฑู ู ุฎุทุงูุง

```php
<form action="" method="POST" novalidate id="validationForm">
    <div class="form-group">
        <label>ูุงู ฺฉุงูู:</label>
        <input type="text" name="name" id="inputName" 
               value="<?php echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8'); ?>" 
               class="<?php echo isset($errors['name']) ? 'input-error' : ''; ?>">
        <?php if (isset($errors['name'])): ?>
            <div class="error-msg"><?php echo $errors['name']; ?></div>
        <?php endif; ?>
    </div>
    <!-- ... ุณุงุฑ ูุฑูุฏโูุง ... -->
</form>
```

**ุชูุถุญ:**

#### ุงูู) `novalidate`
- ุบุฑูุนุงู ฺฉุฑุฏู validation ูุฑูุฑฺฏุฑ
- validation ุณูุช ุณุฑูุฑ ูููโุชุฑ ุงุณุช

#### ุจ) `value="<?php echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8'); ?>"`
- ุงฺฏุฑ ุฎุทุง ุจูุฏุ ุฏุงุฏูโูุง ุฏุฑ ูุฑูุฏ ุจุงู ูโูุงูุฏ
- ฺฉุงุฑุจุฑ ูุงุฒ ูุฏุงุฑุฏ ุฏูุจุงุฑู ุจููุณุฏ

#### ุฌ) `class="<?php echo isset($errors['name']) ? 'input-error' : ''; ?>"`
- ุงฺฏุฑ ุฎุทุง ุจูุฏุ ฺฉูุงุณ `input-error` ุงุถุงูู ูโุดูุฏ
- ูุฑูุฏ ูุฑูุฒ ูโุดูุฏ (ุงุณุชุงู CSS)

#### ุฏ) ููุงุด ุฎุทุง
```php
<?php if (isset($errors['name'])): ?>
    <div class="error-msg"><?php echo $errors['name']; ?></div>
<?php endif; ?>
```
- ุงฺฏุฑ ุฎุทุง ุจูุฏุ ูพุงู ุฎุทุง ููุงุด ุฏุงุฏู ูโุดูุฏ

---

### ุจุฎุด 9: JavaScript - fillForm()

```javascript
function fillForm(name, email, age) {
    const nameInput = document.getElementById('inputName');
    const emailInput = document.getElementById('inputEmail');
    const ageInput = document.getElementById('inputAge');

    nameInput.value = name;
    emailInput.value = email;
    ageInput.value = age;

    [nameInput, emailInput, ageInput].forEach(input => {
        input.style.backgroundColor = '#fffbeb';
        setTimeout(() => input.style.backgroundColor = '', 500);
    });

    if(window.logger) {
        window.logger.log('Interaction', `Filled Form: Name=${name}, Email=${email}, Age=${age}`, 'info');
    }
}
```

**ุชูุถุญ:**
- ุฏฺฉููโูุง ูุซุงู ุฑุง ูพุฑ ูโฺฉูุฏ
- ุฑูฺฏ ุฒุฑุฏ ุจุฑุง ูุดุงู ุฏุงุฏู ุชุบุฑ
- ุซุจุช ุชุนุงููุงุช ุฏุฑ ฺฉูุณูู

---

## ๐งช ูุญูู ุงุณุชูุงุฏู - ูุซุงูโูุง ุนูู

### ูุซุงู 1: ุฏุงุฏู ูุนุชุจุฑ

**ูุฑุญูู 1:** ุฑู ุฏฺฉูู "โ ุฏุงุฏู ูุนุชุจุฑ" ฺฉูฺฉ ฺฉูุฏ
```
ูุงู: ุงูู ุฏุงูุฏุงู
ุงูู: amin@example.com
ุณู: 25
```

**ูุฑุญูู 2:** ุฏฺฉูู "ุจุฑุฑุณ ุงุทูุงุนุงุช" ุฑุง ฺฉูฺฉ ฺฉูุฏ

**ุฎุฑูุฌ:**
```
โ ุชุจุฑฺฉ! ุงุทูุงุนุงุช ุดูุง ุจุง ููููุช ุชุงุฏ ุดุฏ.
ูุงู: ุงูู ุฏุงูุฏุงู
ุงูู: amin@example.com
```

**ุชูุถุญ:**
- ุชูุงู ุงุนุชุจุงุฑุณูุฌโูุง ูููู ุจูุฏูุฏ
- ูพุงู ููููุช ููุงุด ุฏุงุฏู ูโุดูุฏ

---

### ูุซุงู 2: ุฏุงุฏู ูุงูุนุชุจุฑ

**ูุฑุญูู 1:** ุฑู ุฏฺฉูู "โ ุฏุงุฏู ูุงูุนุชุจุฑ" ฺฉูฺฉ ฺฉูุฏ
```
ูุงู: A
ุงูู: invalid-email
ุณู: 10
```

**ูุฑุญูู 2:** ุฏฺฉูู "ุจุฑุฑุณ ุงุทูุงุนุงุช" ุฑุง ฺฉูฺฉ ฺฉูุฏ

**ุฎุฑูุฌ:**
```
โ ูุงู ุจุงุฏ ุญุฏุงูู ณ ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ.
โ ูุฑูุช ุงูู ุตุญุญ ูุณุช.
โ ุณู ุจุงุฏ ุนุฏุฏ ู ุญุฏุงูู ฑธ ุณุงู ุจุงุดุฏ.
```

**ุชูุถุญ:**
- ุณู ุฎุทุง ุงูุช ุดุฏ
- ูุฑูุฏโูุง ูุฑูุฒ ุดุฏูุฏ
- ูพุงูโูุง ุฎุทุง ููุงุด ุฏุงุฏู ุดุฏูุฏ

---

### ูุซุงู 3: ุชุณุช XSS

**ูุฑุญูู 1:** ุฑู ุฏฺฉูู "๐ ุชุณุช XSS" ฺฉูฺฉ ฺฉูุฏ
```
ูุงู: <script>alert(1)</script>
ุงูู: admin@site.com
ุณู: 20
```

**ูุฑุญูู 2:** ุฏฺฉูู "ุจุฑุฑุณ ุงุทูุงุนุงุช" ุฑุง ฺฉูฺฉ ฺฉูุฏ

**ุฎุฑูุฌ:**
```
โ ูุงู ุจุงุฏ ุญุฏุงูู ณ ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ.
```

**ุชูุถุญ:**
- ุงุณฺฉุฑูพุช ุงุฌุฑุง ููโุดูุฏ (ุจู ุฏูู `htmlspecialchars()`)
- ููุท ฺฉ ุฎุทุง: ูุงู ฺฉูุชุงู ุงุณุช
- `<script>alert(1)</script>` = ฒฒ ฺฉุงุฑุงฺฉุชุฑ โ (ุงูุง validation ุฏฺฏุฑ ุจุฑุฑุณ ูโฺฉูุฏ)

---

## ๐ ูฺฉุงุช ุงููุช

### โ ููุงุท ููุช ุงู ฺฉุฏ

1. **Validation ุณูุช ุณุฑูุฑ**
   ```php
   if ($_SERVER["REQUEST_METHOD"] == "POST") {
       // Validation logic
   }
   ```
   - ุชููุง ุฑุงู ูุนุชุจุฑ ุจุฑุง ุงููุช
   - ฺฉุงุฑุจุฑ ููโุชูุงูุฏ bypass ฺฉูุฏ

2. **ุงุณุชูุงุฏู ุงุฒ `htmlspecialchars()`**
   ```php
   echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8');
   ```
   - ุฌููฺฏุฑ ุงุฒ XSS

3. **ุงุณุชูุงุฏู ุงุฒ `mb_strlen()`**
   ```php
   mb_strlen($name) < 3
   ```
   - ูพุดุชุจุงู ุตุญุญ ุงุฒ ูุงุฑุณ

4. **ุงุณุชูุงุฏู ุงุฒ `filter_var()`**
   ```php
   filter_var($email, FILTER_VALIDATE_EMAIL)
   ```
   - ุงุนุชุจุงุฑุณูุฌ ุงูู ุงุณุชุงูุฏุงุฑุฏ

5. **ููุงุด ุฎุทุงูุง**
   ```php
   if (isset($errors['name'])) {
       echo $errors['name'];
   }
   ```
   - ฺฉุงุฑุจุฑ ูโุฏุงูุฏ ฺู ุงุดุชุจุงู ฺฉุฑุฏู

### โ๏ธ ููุงุท ุถุนู (ุจุฑุง ุขููุฒุด)

1. **ุจุฏูู Sanitization**
   - ููุท escape ูโฺฉูุฏุ sanitize ููโฺฉูุฏ
   - ูุซุงู: `<b>ุนู</b>` โ `&lt;b&gt;ุนู&lt;/b&gt;` (ููุงุด ูโุดูุฏ)

2. **ุจุฏูู Rate Limiting**
   - ฺฉุงุฑุจุฑ ูโุชูุงูุฏ ุจโููุงุช ุจุงุฑ ุชูุงุด ฺฉูุฏ

3. **ุจุฏูู CSRF Token**
   - ุญููู CSRF ููฺฉู ุงุณุช

4. **ุจุฏูู Database**
   - ุฏุงุฏูโูุง ุฐุฎุฑู ููโุดููุฏ

---

## ๐ ุฌุฏูู Validation Rules

| ููุฏ | ูุงููู | ูุซุงู ูุนุชุจุฑ | ูุซุงู ูุงูุนุชุจุฑ |
|------|------|----------|-----------|
| **ูุงู** | 3+ ฺฉุงุฑุงฺฉุชุฑ | ุนูุ ุงูู | Aุ AB |
| **ุงูู** | ูุฑูุช ุตุญุญ | user@example.com | invalid-email |
| **ุณู** | ุนุฏุฏ ู 18+ | 25ุ 30 | 10ุ abc |

---

## ๐ ุฏุฑุณโูุง ุงุฏฺฏุฑ

### ุฏุฑุณ 1: Validation ุณูุช ุณุฑูุฑ
- ุชููุง ุฑุงู ูุนุชุจุฑ ุจุฑุง ุงููุช
- ฺฉุงุฑุจุฑ ููโุชูุงูุฏ bypass ฺฉูุฏ

### ุฏุฑุณ 2: Escape vs Sanitize
- **Escape:** ฺฉุงุฑุงฺฉุชุฑูุง ุฎุทุฑูุงฺฉ ุฑุง ุชุจุฏู ูโฺฉูุฏ
- **Sanitize:** ุฏุงุฏูโูุง ูุงููุงุณุจ ุฑุง ุญุฐู ูโฺฉูุฏ

### ุฏุฑุณ 3: ูพุงูโูุง ุฎุทุง
- ุจุงุฏ ูุงุถุญ ู ููุฏ ุจุงุดูุฏ
- ฺฉุงุฑุจุฑ ุจุงุฏ ุจุฏุงูุฏ ฺู ุงุดุชุจุงู ฺฉุฑุฏู

### ุฏุฑุณ 4: UX ู Security
- Validation ุฎูุจุ ุชุฌุฑุจู ฺฉุงุฑุจุฑ ุจูุชุฑ ุงุณุช
- ุฏุงุฏูโูุง ุฏุฑ ูุฑูุฏ ุจุงู ูโูุงูุฏ

---

## ๐ ุงุฑุชุจุงุท ุจุง ูุงูโูุง ุฏฺฏุฑ

- **ูุจู:** `01_get_post.php` - GET ู POST
- **ุจุนุฏ:** `03_xss_demo.php` - XSS ู escape
- **ูุฑุชุจุท:** `final/register.php` - ูุฑู ฺฉุงูู

---

## ๐ ุฎูุงุตู

**`02_validation.php`** ฺฉ ุฏูู ุชุนุงูู ุงุณุช ฺฉู:
- โ ุงุนุชุจุงุฑุณูุฌ ุณูุช ุณุฑูุฑ ุฑุง ูุดุงู ูโุฏูุฏ
- โ ููุงูู ูุฎุชูู validation ุฑุง ูพูุดุด ูโุฏูุฏ
- โ ูพุงูโูุง ุฎุทุง ูุงุถุญ ู ููุฏ ุงุณุช
- โ ูุซุงูโูุง ุนูู ุจุฑุง ุชุณุช ูุฑุงูู ูโฺฉูุฏ

**ููุณูุฏู:** Amin Davodian  
**ูุจุณุงุช:** https://senioramin.com  
**GitHub:** https://github.com/SeniorAminam

---

*Developed by Amin Davodian - Web Security Lab*
